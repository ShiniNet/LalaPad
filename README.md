![LalapadLogo2](https://github.com/user-attachments/assets/e67f79ff-9425-4eba-b59c-047dbce6b11a)
<br/>

LalaPadは液タブ等を用いたクリエイティブな作業を快適にするために、デスク周りの器材（キーボード、マウス、左手デバイス、テンキー等）を統合する目的で開発されました。

![image](https://github.com/user-attachments/assets/6d2ca347-bd2d-4d19-a1a7-67cd6367348d)
![image](https://github.com/user-attachments/assets/980e4df9-8f20-400f-a905-fab9b970171d)
※画像は開発中の物であり、製品版とはわずかに外観が異なる可能性があります。

　
## 特徴

- **有線＆ワイヤレス対応**
- **トラックパッド＆D-Pad搭載**：　左右の入れ替え対応
- **デュアルロータリーエンコーダー搭載**　
- **ロープロ48キー構成**：　ミニマルさを残しつつ、クリエイター、プログラマー向け用途を想定。
- **19mmピッチ**：　普遍的な使用感で、選べるキーキャップの幅が広い
- **ZMKファームウェア搭載**：　ワイヤレスに最適化された最強のファームウェア
- **大容量バッテリースペース**：　1000MAHクラスの3.7Vリポバッテリーを搭載可能
- **背面に強力なマグネットを搭載**：　使用後にPCケースや冷蔵庫等に張り付けて保管可能
- **ケースの3Dデータを公開**：　ユーザー自身で好みのカラバリを作ったり改変したり、出力品を販売可能
<br/><br/>

## 製品の詳細
### [販売ページ](https://shininet.booth.pm/items/6669026)

### [ビルドガイド](doc/BuildGuide.md)

### [3Dモデルデータのダウンロード](https://makerworld.com/en/models/1173447-keyboard-cases-for-lalapad#profileId-1182086)


#### 3Dプリント発注費用の目安（20250220時点
- DMM Make：　16,000円、送料無料（国内配送
- JLC3DP：　20$＋送料13$＋輸入消費税（国際配送

## 工事設計認証(技適)番号
- 使用するMCUモジュール販売元の記載をご確認ください

## SIG認証について
- 本商品は使用できる状態の無線モジュールを含まない自作キットですので、基本的には認証の対象外となります。  
  
  
## 使い方

### 電源の入れ方、充電方法

- 電源スイッチをON（奥行き側）にするか、USB-Cケーブルをマイコンに接続すると起動します。
- 充電はUSB-Cポート経由で行います。電源スイッチがON状態のときにバッテリーが充電されます。
　※キーボードを充電したままの外出や就寝は控え、絶対に目を離さないようにしてください。
- バッテリー残量はキーボード起動時にLEDインジケーター（後述）に表示されます。

### PC等デバイスへの接続と使用
- セントラル（右手側）の電源投入後、周辺（左手側）の電源を投入し、デバイス上で無線機器を検索してペアリングします。
- 各デバイス側でキーボードの物理レイアウトをUS配列に設定してください。

> [!TIP]
> -  周辺（左手側）はセントラル経由でPCに接続されます。セントラル（右手側）は単独で使用できますが、周辺（左手側）はセントラル側と同時に使用する必要があります。

### LEDインジケーターの読み方

#### バッテリーステータス（起動時）
- バッテリーレベルに応じて 🟢(100%)/🟡(30%)/🔴(10%) に点滅します。

#### 接続状態（バッテリーステータスが表示された後）
- [右手側]🔵点滅：デバイスへ接続済み、🟡：接続待ち、🔴：切断
- [左手側]🔵点滅：セントラルへ接続済み、🔴：切断

#### レイヤー状態（レイヤー変更時）
- [右手側]🔵点滅：アクティブにしたレイヤー番号に応じて点滅します。


### デフォルトキーマップ
赤文字：長押しで出力  
青文字：Ctrl押しながら押下で出力  
空白：デフォルトレイヤーから変化なし  
Layer1~3キー：押してる間だけレイヤー変更  
2文字刻印されているキー：SHIFT押しながら押下で右を出力（一般的なキーボードと同様）
- デフォルトレイヤー（Windows向け）
![image](https://github.com/user-attachments/assets/e8ab12d1-77c2-4717-bbf9-fceb7991e168)


- セカンダリレイヤー（左：数字&記号、右：テンキー）
![2025-03-01_07h08_14](https://github.com/user-attachments/assets/952c061a-31e6-4ee1-adf0-e5d72028b599)

- ターシャリレイヤー（ファンクションキー）
![2025-03-01_07h08_16](https://github.com/user-attachments/assets/4ccf3000-e57b-4ed2-816e-9fc210c041a1)

- システムレイヤー（無線接続先選択＆プロファイルクリア、ブートローダー、ZMK Studioロック解除Etc…）
![image](https://github.com/user-attachments/assets/11167f13-e23a-4041-ba2b-bdcc3217b17e)



### トラックパッドの機能
- マウスポインターの操作
- カーソル操作でマウスレイヤーに自動切替
- マウススクロールモード
- 低速モード
  
> [!TIP]
> トラックパッド操作中はホームポジションから右に１つポジションをズラして操作する想定でデフォルトキーマップを作りこんでいます。
> ホームポジションのままマウス操作したい場合はマウスレイヤーのキーマップを左に１つずつ移動させることを推奨（但し親指でのトラックパッド操作がやや辛くなる  

  
![image](https://github.com/user-attachments/assets/acd9b2de-2bcc-4bee-848d-981af18d1684)  

### キーマップの変更
- [キーコード一覧](https://zmk.dev/docs/keymaps/list-of-keycodes)
#### [ZMK Studio（ベータ版）](https://zmk.studio/)を使用
- Webブラウザ上で簡単に編集可能（USB経由)
- ネイティブアプリ版を使えば無線接続のまま編集可能
- ファームウェアのビルド不要

　参考：[ZMK Studio - ZMK Firmwear Docs](https://zmk.dev/docs/features/studio)

#### [KeymapEditor](https://nickcoutsos.github.io/keymap-editor/)を使用
- Webブラウザ上で簡単に編集可能
- ZMK Studioより詳細な設定が可能
- ファームウェアをビルドする為にGitHubアカウントが必要です

　[KeymapEditorの使い方](https://github.com/ShiniNet/LalaPad/blob/main/doc/KeymapEdit.md)<br/>
 　

### ファームウェアを直接カスタマイズ
- ZMKの全ての機能を利用できます（独自のマクロ追加など）
- キーボードのプロパティを変更できます（トラックパッドのドライバ変更やスリープ時間の閾値調整等）
- 若干のC言語+DeviceTreeの知識が必要です

　[ファームウェアを直接変更する方法](https://github.com/ShiniNet/LalaPad/blob/main/doc/EditFirmwareDirectly.md)<br/>
 
　参考：[ZMK Firmwear Docs](https://zmk.dev/docs/config)<br/>


<br/><br/>

## よくある質問

**Q: バッテリーの持ちはどれくらいですか？**  
A: 1000mahバッテリー搭載で、セントラル側が毎日デスクワークに使用して1~2週間のバッテリー持ちを確認しています。周辺側はこれの更に数倍持つと思われます。

**Q: どんなOSに対応していますか？**  
A: ZMKファームウェアが対応している各OS（Windows,Linux,Android,macOS,iOS）のキーコードが利用可能です。詳しくは[ZMKキーコードリスト](https://zmk.dev/docs/keymaps/list-of-keycodes)

**Q: 日本語配列に対応していますか？**  
A: ZMKはUS配列を前提にしたファームウェアです。一応日本語配列向けのキーコード（INT1-5、変換、無変換など）は定義されているようですが検証が不十分です。貢献をお待ちしております。

**Q: レイヤー数は増やせますか？**  
A: 基本的にはハードウェアのメモリが許す限りいくらでも増やす事ができます。

**Q: デュアルトラックパッド化できますか？**  
A: 可能です。左手側のDpadモジュールを取り外しキーボードとトラックパッドをFFCケーブル12PINで接続したらキーボードを再起動してください。追加のトラックパッドモジュールとFFCケーブルはユーザーご自身で用意して頂く必要があります。
　　※セントラル側と比較して5ms程度レスポンスが低下する可能性があります。

**Q: なんで片側５列にしなかったんですか？ミニマルじゃないです**  
A: 僕がゲームしたいからです。
  
**Q: なんでデフォルトキーマップに数字キーが２系統存在するんですか？無意味では？**  
A: いくつかのアプリではこれらのキーが区別して扱われるからです。少なくともBlenderではテンキーは視点操作などで頻繁に使用する為、代替の効かないキーとなっています。
<br/><br/>
  
**Q: 組立中に基盤or部品を破損してしまいました。基板または部品だけの再購入は可能ですか？**  
A: 可能です。ショップオーナーにご相談ください。部品代の他に国際配送料がかかることを予めご了承ください。または[BOM](doc/partsList.md)を参考にユーザー自身でパーツを調達することもできます。

<br/><br/>



## トラブルシューティング

**Q: 無線接続でデバイスとのペアリングができません**  
A0:　セントラル（右手側）⇒周辺（左手側）の順でキーボードの電源をONにして、PC等デバイス側で周囲の無線機器を検索し、"Lalapad"という機器が表示されるのを確認したらそれを選択し、接続してください。

A1:　マイコンのリセットボタンを押して、デバイスと再接続してみてください。

A2:　PCとキーボード双方のペアリング情報を一旦削除（BLE_CLR_ALL）して、再度デバイスとペアリングしてみてください。

A3:　それでも上手く行かない場合（上記が良く分からない場合）、[リセット用ファームウェア](https://github.com/ShiniNet/LalaPad/blob/main/firmware/FirmwearReset.uf2)を左右のキーボードに書き込み初期化したのち、もう一度ファームウェアを書き込んでみて再接続してみてください。

A4:　それでも上手くいかない場合、別の無線機器（スマホなど）との接続を検証してキーボードの問題かどうかを切り分けしてみてください。

A5:　電源投入時にLEDインジケーターが点灯しているかどうかを確認してください。点灯しない場合、マイコンが通電していない可能性がありますので、はんだづけの不良をチェックしてください。

**Q: 左手側のキーボードが動作しません**  
A1:　右手用キーボードの電源をONにしてから左手キーボードを使用してください。左手側は右手側（セントラル）を経由してPC等デバイスと接続している為です。

A2:　左右キーボードのペアリングに失敗している可能性があります。一度双方の電源を落とし、右手側⇒左手側の順番で電源をONにしてみてください。

A3:　それでも上手く行かない場合、[リセット用ファームウェア](https://github.com/ShiniNet/LalaPad/blob/main/firmware/FirmwearReset.uf2)を左右のキーボードに書き込み初期化したのち、もう一度ファームウェアを書き込んでみて再接続してみてください。


**Q: 無線接続が不安定です**  
A1:　マイコンのリセットボタンを押して、デバイスと再接続してみてください。

A2:　PC側のBLEドングルとキーボードの間に大きな金属製の物を置かないように（モニターなど）してください。

A3:　集合住宅やオフィスなど混線しやすい環境ではUSB接続による使用を推奨します。

**Q: 入力したキーに対してPC側で異なるキーが出力されます**  
A1:　本キーボードはデフォルトでUS配列になっています。お使いのPC等デバイスのキーボード設定が日本語配列モードになっている場合、US配列モードに変更してからご使用ください。

**Q: トラックパッドの初動がもたつきます**  
A1:　約5分間キーボードが操作されないとキーボードがアイドル状態に入り、トラックパッドがスリープします。再アクティブ化には0.3秒前後かかる仕様です。閾値は変更可能です。

**Q: トラックパッドの動作が不安定になるときがあります**  
A1:　本キーボードは静電容量式トラックパッドを採用しています。周囲からの電磁ノイズやキャリブレーションのズレにより動作が不安定になる場合があります。その場合、マイコンのリセットボタンを押してキーボードを再起動するか、スイッチをOFFにして電荷を十分に抜いてからONにしてください。起動時にトラックパッドが再キャリブレーション(0.1秒)されます。※キャリブレーション中にトラックパッドに触れるとキャリブレーションが正しく行われない可能性があります。  
A2:　一般的な静電容量パネル（スマホ等）でありがちなゴーストタッチ対策をお試しください。  
A3:　手指の乾燥度合いやトラックパッドに装飾用のカバーやシール等を装着している場合、感度が鈍くなることがあります。その場合[センサー感度を上げる](https://github.com/ShiniNet/LalaPad/blob/main/doc/EditFirmwareDirectly.md#%E3%83%88%E3%83%A9%E3%83%83%E3%82%AF%E3%83%91%E3%83%83%E3%83%89%E3%81%AE%E3%82%BB%E3%83%B3%E3%82%B5%E3%83%BC%E6%84%9F%E5%BA%A6%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B)ことで改善することがあります。  


**Q: キーボードの初動がもたつきます**  
A1:　約１時間キーボードが操作されないとキーボードがスリープ状態に入り、無線接続が解除されます。再アクティブ化に５秒前後かかる仕様になっています。閾値は変更可能です。
  
多くのトラブルは、他のZMKファームウェアを搭載するキーボードと共通しますので、ZMKが提供する[トラブルシューティングのドキュメント](https://zmk.dev/docs/troubleshooting )が役立ちます。
<br/><br/>

## 注意事項・免責
- 本キーボード自作キットは個人が趣味で開発した作品を頒布しているものであり、またユーザー自身がバッテリー等部品の選定や組み立てを行うという性質上、完成品に対して一般的な製品のような品質や安全性は保障されておらず、十分なサポートや保障を得られない可能性がある事をよく理解し、自己責任でご利用ください。
- 本キーボード自作キットを使用した際のいかなる損害についても、開発者は責任を負いかねます。
- 明らかな初期不良や、部品の欠品などがあった場合は販売元へBoothのメッセージよりお問い合わせください。※転売や海賊版対策の為、必ず製品を購入したアカウントから問い合わせを行ってください。
- [リポバッテリーの取り扱いにおける一般的な注意事項](https://www.baj.or.jp/battery/safety/safety16.html)を遵守してください。
- 同梱のケースは家庭用3Dプリンターによる出力品の為、嵌め込み部分など使用者の手元で研磨が必要になる場合があります。予めご了承ください。
- 配布している3Dデータは家庭用FDM方式の3Dプリンターに最適化された物であり、発注先や使用される素材や印刷方式によって出力品の特性はわずかに異なることから、すべてのケースにおいて適合を保証するものではありません。各自で調整の上、自己責任でご利用ください。
- 地理的な事情により開発者による物理的なサポートが制限されることを予めご了承ください（往復の国際配送料がかかる為、修理の受付が現実的ではない等）。その代わり修理部品の手配方法の案内など、できる限りのサポートをさせて頂きます！
<br/><br/>

